<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Class Maker</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Lato:100,300,400,700,900" rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

<!-- THIS HIDES AND SHOWS VEIL -->
<!--<div id="landscape_veil" class="landscape_veil"><h2>Turn your phone please. </h2></div>-->

<!-- NAVIGATION -->
<nav id="toolbar" class="toolbar">
    <div id="logo" class="logo">Class Maker</div>
    <div id="menuButton" class="menuButton fa fa-bars"></div>
</nav>

<!-- PAGE CONTAINER-->
<div id="container" class="container">

    <!-- MAIN MENU -->
    <div id="menu" class="menu">
        <ul>
            <li class="menu_item">(email)</li>
            <li class="menu_item">Profile</li>
            <li class="menu_item">Settings</li>
            <li class="menu_item">Help</li>
            <li class="menu_item">Log Out</li>
        </ul>
    </div>
    <div class="modal_veil"></div>

    <!-- STUDENT VIEW -->
    <div class="students_title"> Students </div>
    <div id="students_view" class="students_view">

        <!-- TODO: All of these elements to be dynamically created. -->
        <!--<div>-->
            <!--<img src="images/penguin_sm.jpg">-->
            <!--<div class="score">6.7</div>-->
            <!--<div class="name">Jefferson Wu</div>-->
        <!--</div>-->

        <!--<div>-->
            <!--<img src="images/penguin_sm.jpg">-->
            <!--<div class="score">7.8</div>-->
            <!--<div class="name">Shirley Yang</div>-->
        <!--</div>-->

        <!--<div>-->
            <!--<img src="images/penguin_sm.jpg">-->
            <!--<div class="score">3.2</div>-->
            <!--<div class="name">Wynbertson Gan</div>-->
        <!--</div>-->

        <!--<div>-->
            <!--<img src="images/penguin_sm.jpg">-->
            <!--<div class="score">7.8</div>-->
            <!--<div class="name">Wayne Dong</div>-->
        <!--</div>-->

        <!--<div>-->
            <!--<img src="images/penguin_sm.jpg">-->
            <!--<div class="score">4.5</div>-->
            <!--<div class="name">Jimmy Duong</div>-->
        <!--</div>-->

        <!--<div>-->
            <!--<img src="images/penguin_sm.jpg">-->
            <!--<div class="score">7.7</div>-->
            <!--<div class="name">Janet Chu</div>-->
        <!--</div>-->

        <!--<div>-->
            <!--<img src="images/penguin_sm.jpg">-->
            <!--<div class="score">5.4</div>-->
            <!--<div class="name"> John Huynh</div>-->
        <!--</div>-->

        <!--<div>-->
            <!--<img src="images/penguin_sm.jpg">-->
            <!--<div class="score">3.4</div>-->
            <!--<div class="name">Julie Dong</div>-->
        <!--</div>-->

        <!--<div>-->
            <!--<img src="images/penguin_sm.jpg">-->
            <!--<div class="score">6.7</div>-->
            <!--<div class="name">Jefferson Wu</div>-->
        <!--</div>-->

        <!--<div>-->
            <!--<img src="images/penguin_sm.jpg">-->
            <!--<div class="score">7.8</div>-->
            <!--<div class="name">Shirley Yang</div>-->
        <!--</div>-->

        <!--<div>-->
            <!--<img src="images/penguin_sm.jpg">-->
            <!--<div class="score">3.2</div>-->
            <!--<div class="name">Wynbertson Gan</div>-->
        <!--</div>-->

        <!--<div>-->
            <!--<img src="images/penguin_sm.jpg">-->
            <!--<div class="score">7.8</div>-->
            <!--<div class="name">Wayne Dong</div>-->
        <!--</div>-->

        <!--<div>-->
            <!--<img src="images/penguin_sm.jpg">-->
            <!--<div class="score">4.5</div>-->
            <!--<div class="name">Jimmy Duong</div>-->
        <!--</div>-->

        <!--<div>-->
            <!--<img src="images/penguin_sm.jpg">-->
            <!--<div class="score">7.7</div>-->
            <!--<div class="name">Janet Chu</div>-->
        <!--</div>-->

        <!--<div>-->
            <!--<img src="images/penguin_sm.jpg">-->
            <!--<div class="score">5.4</div>-->
            <!--<div class="name"> John Huynh</div>-->
        <!--</div>-->

        <!--<div>-->
            <!--<img src="images/penguin_sm.jpg">-->
            <!--<div class="score">3.4</div>-->
            <!--<div class="name">Julie Dong</div>-->
        <!--</div>-->




    </div>
    <!-- STUDENT VIEW - END -->
</div>
<!-- MAIN MENU - END -->



<script src="js/logic_toolbar.js"></script>

<script>

    // FUNCTIONS ----------------
    function update_view(data_object, target_div) {

        data_object.forEach(function(elem, ind, arr){

            var div = document.createElement('div');
            div.id = data_object[ind].student_id;

            var img = document.createElement('img');
            img.src = 'images/penguin_sm.jpg';

            var score_div = document.createElement('div');
            score_div.classList.add('score');

            // DATA CHECK
            score_div.innerHTML = get_average_score(data_object[ind]);


            var name_div = document.createElement('div');
            score_div.classList.add('name');
            name_div.innerHTML = data_object[ind].firstname + ' ' + data_object[ind].lastname;

            div.appendChild(img);
            div.appendChild(score_div);
            div.appendChild(name_div);

            target_div.appendChild(div);
        });
    }

    function get_average_score(data_object) {
        return ((data_object.stats.behavior + data_object.stats.math + data_object.stats.english + data_object.stats.science) / 4).toFixed(1);
    }

    // EVENTS --------------------
    window.addEventListener('DOMContentLoaded', function(e){
        $.ajax({
            method: 'GET',
            url: '/api/student',
            success: function(data, status, jqxhr) {
                console.log(data.payload);
                update_view(data.payload.students, document.getElementById('students_view'));
            },
            error: function(jqxhr, status, err) {
                console.log(err);
            }
        });
    });
</script>

</body>
</html>